# 观察者模式
[toc]

## 何为观察者模式
* 出版者+订阅者=观察者模式

例如：
1. 晨光牛奶预订的牛奶，会有人每天送到家中
2. 报社订阅的报纸，每天有新报纸发行的时候就会有人送到家中
3. 手机各种APP的推送，出现了各种新闻，热点就进行推送到手机的通知栏
当然这条例子是不完全的，APP的推送属于流氓形式，不允许退订，只要你安装了APP，就一定会受到各种推送。

## 观察者模式
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="289px" preserveAspectRatio="none" style="width:578px;height:289px;" version="1.1" viewBox="0 0 578 289" width="578px" zoomAndPan="magnify"><defs><filter height="300%" id="f8bfiyar9ccyg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster 观察者--><rect fill="#FFFFFF" filter="url(#f8bfiyar9ccyg)" height="153" style="stroke: #000000; stroke-width: 1.5;" width="342" x="225" y="125"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="373.5" y="139.9951">观察者</text><!--entity 订阅者1--><ellipse cx="525" cy="189" fill="#FEFECE" filter="url(#f8bfiyar9ccyg)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M525,197 L525,224 M512,205 L538,205 M525,224 L512,239 M525,224 L538,239 " fill="none" filter="url(#f8bfiyar9ccyg)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="499.5" y="258.9951">订阅者1</text><!--entity 订阅者2--><ellipse cx="439" cy="189" fill="#FEFECE" filter="url(#f8bfiyar9ccyg)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M439,197 L439,224 M426,205 L452,205 M439,224 L426,239 M439,224 L452,239 " fill="none" filter="url(#f8bfiyar9ccyg)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="413.5" y="258.9951">订阅者2</text><!--entity 订阅者3--><ellipse cx="353" cy="189" fill="#FEFECE" filter="url(#f8bfiyar9ccyg)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M353,197 L353,224 M340,205 L366,205 M353,224 L340,239 M353,224 L366,239 " fill="none" filter="url(#f8bfiyar9ccyg)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="327.5" y="258.9951">订阅者3</text><!--entity 订阅者4--><ellipse cx="267" cy="189" fill="#FEFECE" filter="url(#f8bfiyar9ccyg)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M267,197 L267,224 M254,205 L280,205 M267,224 L254,239 M267,224 L280,239 " fill="none" filter="url(#f8bfiyar9ccyg)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="241.5" y="258.9951">订阅者4</text><!--entity 出版者--><ellipse cx="132" cy="189" fill="#FEFECE" filter="url(#f8bfiyar9ccyg)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M132,197 L132,224 M119,205 L145,205 M132,224 L119,239 M132,224 L145,239 " fill="none" filter="url(#f8bfiyar9ccyg)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="111" y="258.9951">出版者</text><!--entity 旁观者--><ellipse cx="27" cy="189" fill="#FEFECE" filter="url(#f8bfiyar9ccyg)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,197 L27,224 M14,205 L40,205 M27,224 L14,239 M27,224 L40,239 " fill="none" filter="url(#f8bfiyar9ccyg)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="6" y="258.9951">旁观者</text><!--link 出版者 to 订阅者1--><path d="M153.035,184.828 C169.313,161.002 194.243,131.624 225,118 C277.218,94.87 434.442,86.378 482,118 C500.894,130.563 511.503,153.207 517.452,174.022 " fill="none" id="出版者-订阅者1" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="518.794,178.986,520.3045,169.2537,517.4881,174.1596,512.5822,171.3431,518.794,178.986" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="401.5" y="105.0669">data</text><!--link 出版者 to 订阅者2--><path d="M153.035,184.828 C169.313,161.002 194.243,131.624 225,118 C259.744,102.61 364.357,96.96 396,118 C414.894,130.563 425.503,153.207 431.452,174.022 " fill="none" id="出版者-订阅者2" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="432.794,178.986,434.3045,169.2537,431.4881,174.1596,426.5822,171.3431,432.794,178.986" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="180.5" y="105.0669">data</text><!--link 出版者 to 订阅者3--><path d="M153.035,184.828 C169.313,161.002 194.243,131.624 225,118 C259.541,102.7 278.542,97.083 310,118 C328.894,130.563 339.503,153.207 345.452,174.022 " fill="none" id="出版者-订阅者3" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="346.794,178.986,348.3045,169.2537,345.4881,174.1596,340.5822,171.3431,346.794,178.986" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="270.5" y="105.0669">data</text><!--link 订阅者4 to 出版者--><path d="M241.449,220.5 C217.667,220.5 182.376,220.5 158.344,220.5 " fill="none" id="订阅者4-出版者" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="153.094,220.5,162.094,224.5,158.094,220.5,162.094,216.5,153.094,220.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="171.25" y="213.5669">取消订阅</text><!--link 旁观者 to 出版者--><path d="M48.2483,220.5 C64.7575,220.5 87.7491,220.5 105.467,220.5 " fill="none" id="旁观者-出版者" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="110.783,220.5,101.783,216.5,105.783,220.5,101.783,224.5,110.783,220.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="66.5" y="213.5669">订阅</text><!--
@startuml
actor 出版者
actor 旁观者
rectangle 观察者 {
actor 订阅者1
actor 订阅者2
actor 订阅者3
actor 订阅者4
}
出版者 .> 订阅者1 : data
出版者 .> 订阅者2 : data
出版者 .> 订阅者3 : data
订阅者4 -> 出版者 : 取消订阅
旁观者 -> 出版者 : 订阅
@enduml
--></g></svg>

## 观察者模式实现
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="380px" preserveAspectRatio="none" style="width:277px;height:380px;" version="1.1" viewBox="0 0 277 380" width="277px" zoomAndPan="magnify"><defs><filter height="300%" id="fgjjkk2okuz12" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class Observer--><rect fill="#FEFECE" filter="url(#fgjjkk2okuz12)" height="60.8047" id="Observer" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="7" y="171"/><ellipse cx="22" cy="187" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M22.9531,183.7813 L22.9531,190.2969 L24.6719,190.2969 C25.125,190.2969 25.2656,190.3281 25.4375,190.4531 C25.6719,190.625 25.7813,190.875 25.7813,191.1563 C25.7813,191.7188 25.4219,192 24.6719,192 L19.5313,192 C19.125,192 18.9219,191.9531 18.7656,191.8281 C18.5469,191.6719 18.4063,191.4063 18.4063,191.1563 C18.4063,190.8594 18.5625,190.5781 18.8125,190.4219 C18.9688,190.3125 19.0938,190.2969 19.5313,190.2969 L21.25,190.2969 L21.25,183.7813 L19.5313,183.7813 C19.1094,183.7813 18.9219,183.75 18.7656,183.6406 C18.5469,183.4688 18.4063,183.2188 18.4063,182.9375 C18.4063,182.6563 18.5625,182.3594 18.8125,182.2031 C18.9688,182.1094 19.0938,182.0938 19.5313,182.0938 L24.6719,182.0938 C25.125,182.0938 25.2656,182.125 25.4375,182.2344 C25.6719,182.4063 25.7813,182.6719 25.7813,182.9375 C25.7813,183.2344 25.6406,183.5156 25.375,183.6719 C25.25,183.75 25.0625,183.7813 24.6719,183.7813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="54" x="36" y="191.1543">Observer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="8" x2="92" y1="203" y2="203"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="8" x2="92" y1="211" y2="211"/><ellipse cx="18" cy="222.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="27" y="225.2104">update()</text><!--class Subject--><rect fill="#FEFECE" filter="url(#fgjjkk2okuz12)" height="86.4141" id="Subject" style="stroke: #A80036; stroke-width: 1.5;" width="240" x="6" y="8"/><ellipse cx="98.25" cy="24" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M99.2031,20.7813 L99.2031,27.2969 L100.9219,27.2969 C101.375,27.2969 101.5156,27.3281 101.6875,27.4531 C101.9219,27.625 102.0313,27.875 102.0313,28.1563 C102.0313,28.7188 101.6719,29 100.9219,29 L95.7813,29 C95.375,29 95.1719,28.9531 95.0156,28.8281 C94.7969,28.6719 94.6563,28.4063 94.6563,28.1563 C94.6563,27.8594 94.8125,27.5781 95.0625,27.4219 C95.2188,27.3125 95.3438,27.2969 95.7813,27.2969 L97.5,27.2969 L97.5,20.7813 L95.7813,20.7813 C95.3594,20.7813 95.1719,20.75 95.0156,20.6406 C94.7969,20.4688 94.6563,20.2188 94.6563,19.9375 C94.6563,19.6563 94.8125,19.3594 95.0625,19.2031 C95.2188,19.1094 95.3438,19.0938 95.7813,19.0938 L100.9219,19.0938 C101.375,19.0938 101.5156,19.125 101.6875,19.2344 C101.9219,19.4063 102.0313,19.6719 102.0313,19.9375 C102.0313,20.2344 101.8906,20.5156 101.625,20.6719 C101.5,20.75 101.3125,20.7813 100.9219,20.7813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="47" x="118.75" y="28.1543">Subject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="245" y1="40" y2="40"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="245" y1="48" y2="48"/><ellipse cx="17" cy="59.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="214" x="26" y="62.2104">registerObserver(Observer observer)</text><ellipse cx="17" cy="72.707" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="26" y="75.0151">removeObserver(Observer observer)</text><ellipse cx="17" cy="85.5117" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="92" x="26" y="87.8198">notifyObserver()</text><!--class ConcreteSubject--><rect fill="#FEFECE" filter="url(#fgjjkk2okuz12)" height="60.8047" id="ConcreteSubject" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="128" y="171"/><ellipse cx="143.9" cy="187" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M146.2438,182.6719 L146.4156,182.75 C146.6344,182.4375 146.8375,182.3438 147.1344,182.3438 C147.4313,182.3438 147.7125,182.4844 147.8688,182.75 C147.9625,182.9063 147.9781,183.0313 147.9781,183.4688 L147.9781,184.8906 C147.9781,185.3125 147.9469,185.5 147.8375,185.6563 C147.6656,185.875 147.4,186.0156 147.1344,186.0156 C146.9156,186.0156 146.6813,185.9063 146.5406,185.7656 C146.4,185.6406 146.3688,185.5156 146.3063,185.1094 C146.2125,184.7031 146.0406,184.4844 145.5563,184.2031 C145.0875,183.9531 144.4781,183.7969 143.9,183.7969 C142.1656,183.7969 140.9156,185.1094 140.9156,186.8906 L140.9156,187.9844 C140.9156,189.6875 142.2125,190.7813 144.2594,190.7813 C145.025,190.7813 145.7125,190.6563 146.1344,190.3906 C146.3219,190.2969 146.3219,190.2969 146.775,189.8125 C146.9625,189.625 147.1656,189.5469 147.3844,189.5469 C147.8531,189.5469 148.2438,189.9375 148.2438,190.3906 C148.2438,190.7813 147.9156,191.2344 147.3375,191.6406 C146.5875,192.1875 145.4313,192.4844 144.2125,192.4844 C141.3219,192.4844 139.2125,190.5938 139.2125,188.0156 L139.2125,186.8906 C139.2125,184.1719 141.2125,182.0938 143.8375,182.0938 C144.7125,182.0938 145.3063,182.2344 146.2438,182.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="104" x="158.1" y="191.1543">ConcreteSubject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="129" x2="265" y1="203" y2="203"/><ellipse cx="139" cy="214.9023" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="112" x="148" y="217.2104">List&lt;Observer&gt; list</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="129" x2="265" y1="223.8047" y2="223.8047"/><!--class ConcreteObserver--><rect fill="#FEFECE" filter="url(#fgjjkk2okuz12)" height="60.8047" id="ConcreteObserver" style="stroke: #A80036; stroke-width: 1.5;" width="145" x="61.5" y="309"/><ellipse cx="76.5" cy="325" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M78.8438,320.6719 L79.0156,320.75 C79.2344,320.4375 79.4375,320.3438 79.7344,320.3438 C80.0313,320.3438 80.3125,320.4844 80.4688,320.75 C80.5625,320.9063 80.5781,321.0313 80.5781,321.4688 L80.5781,322.8906 C80.5781,323.3125 80.5469,323.5 80.4375,323.6563 C80.2656,323.875 80,324.0156 79.7344,324.0156 C79.5156,324.0156 79.2813,323.9063 79.1406,323.7656 C79,323.6406 78.9688,323.5156 78.9063,323.1094 C78.8125,322.7031 78.6406,322.4844 78.1563,322.2031 C77.6875,321.9531 77.0781,321.7969 76.5,321.7969 C74.7656,321.7969 73.5156,323.1094 73.5156,324.8906 L73.5156,325.9844 C73.5156,327.6875 74.8125,328.7813 76.8594,328.7813 C77.625,328.7813 78.3125,328.6563 78.7344,328.3906 C78.9219,328.2969 78.9219,328.2969 79.375,327.8125 C79.5625,327.625 79.7656,327.5469 79.9844,327.5469 C80.4531,327.5469 80.8438,327.9375 80.8438,328.3906 C80.8438,328.7813 80.5156,329.2344 79.9375,329.6406 C79.1875,330.1875 78.0313,330.4844 76.8125,330.4844 C73.9219,330.4844 71.8125,328.5938 71.8125,326.0156 L71.8125,324.8906 C71.8125,322.1719 73.8125,320.0938 76.4375,320.0938 C77.3125,320.0938 77.9063,320.2344 78.8438,320.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="113" x="90.5" y="329.1543">ConcreteObserver</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="62.5" x2="205.5" y1="341" y2="341"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="62.5" x2="205.5" y1="349" y2="349"/><ellipse cx="72.5" cy="360.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="81.5" y="363.2104">update()</text><!--link Observer to ConcreteObserver--><path d="M78.7964,249.123 C90.955,268.808 104.7569,291.1541 115.519,308.578 " fill="none" id="Observer-ConcreteObserver" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="72.7811,252.704,68.2267,232.01,84.6922,245.347,72.7811,252.704" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ConcreteSubject to ConcreteObserver--><path d="M181.189,236.631 C170.936,258.766 157.703,287.3315 147.861,308.578 " fill="none" id="ConcreteSubject-ConcreteObserver" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="183.33,232.01,175.918,238.4955,181.2286,236.547,183.1771,241.8577,183.33,232.01" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="170" y="275.0669">subject</text><!--link Subject to Observer--><path d="M80.5194,94.288 C72.9309,103.4 65.9344,113.48 61,124 C55.014,136.762 52.0886,151.933 50.7198,165.386 " fill="none" id="Subject-Observer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="50.2534,170.643,55.0324,162.0313,50.6948,165.6625,47.0636,161.325,50.2534,170.643" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="62" y="137.0669">many Observer</text><!--link Subject to ConcreteSubject--><path d="M162.875,111.858 C165.029,115.924 167.092,119.995 169,124 C176.178,139.066 182.688,156.497 187.62,170.911 " fill="none" id="Subject-ConcreteSubject" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="156.706,115.169,153.047,94.298,168.923,108.332,156.706,115.169" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
interface Observer {
+update()
}
interface Subject {
+registerObserver(Observer observer)
+removeObserver(Observer observer)
+notifyObserver()
}
class ConcreteSubject {
+List<Observer> list
}
class ConcreteObserver {
+update()
}
Observer <|.. ConcreteObserver 
ConcreteSubject <- - ConcreteObserver: subject
Subject - -> Observer : many Observer
Subject <|.. ConcreteSubject
@enduml
--></g></svg>

## JAVA 内置观察者模式
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="393px" preserveAspectRatio="none" style="width:274px;height:393px;" version="1.1" viewBox="0 0 274 393" width="274px" zoomAndPan="magnify"><defs><filter height="300%" id="f1p72u34qysgli" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class Observer--><rect fill="#FEFECE" filter="url(#f1p72u34qysgli)" height="60.8047" id="Observer" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="6" y="184"/><ellipse cx="21" cy="200" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M21.9531,196.7813 L21.9531,203.2969 L23.6719,203.2969 C24.125,203.2969 24.2656,203.3281 24.4375,203.4531 C24.6719,203.625 24.7813,203.875 24.7813,204.1563 C24.7813,204.7188 24.4219,205 23.6719,205 L18.5313,205 C18.125,205 17.9219,204.9531 17.7656,204.8281 C17.5469,204.6719 17.4063,204.4063 17.4063,204.1563 C17.4063,203.8594 17.5625,203.5781 17.8125,203.4219 C17.9688,203.3125 18.0938,203.2969 18.5313,203.2969 L20.25,203.2969 L20.25,196.7813 L18.5313,196.7813 C18.1094,196.7813 17.9219,196.75 17.7656,196.6406 C17.5469,196.4688 17.4063,196.2188 17.4063,195.9375 C17.4063,195.6563 17.5625,195.3594 17.8125,195.2031 C17.9688,195.1094 18.0938,195.0938 18.5313,195.0938 L23.6719,195.0938 C24.125,195.0938 24.2656,195.125 24.4375,195.2344 C24.6719,195.4063 24.7813,195.6719 24.7813,195.9375 C24.7813,196.2344 24.6406,196.5156 24.375,196.6719 C24.25,196.75 24.0625,196.7813 23.6719,196.7813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="54" x="35" y="204.1543">Observer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="91" y1="216" y2="216"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="91" y1="224" y2="224"/><ellipse cx="17" cy="235.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="26" y="238.2104">update()</text><!--class Observable--><rect fill="#FEFECE" filter="url(#f1p72u34qysgli)" height="99.2188" id="Observable" style="stroke: #A80036; stroke-width: 1.5;" width="230" x="9" y="8"/><ellipse cx="84.75" cy="24" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M87.0938,19.6719 L87.2656,19.75 C87.4844,19.4375 87.6875,19.3438 87.9844,19.3438 C88.2813,19.3438 88.5625,19.4844 88.7188,19.75 C88.8125,19.9063 88.8281,20.0313 88.8281,20.4688 L88.8281,21.8906 C88.8281,22.3125 88.7969,22.5 88.6875,22.6563 C88.5156,22.875 88.25,23.0156 87.9844,23.0156 C87.7656,23.0156 87.5313,22.9063 87.3906,22.7656 C87.25,22.6406 87.2188,22.5156 87.1563,22.1094 C87.0625,21.7031 86.8906,21.4844 86.4063,21.2031 C85.9375,20.9531 85.3281,20.7969 84.75,20.7969 C83.0156,20.7969 81.7656,22.1094 81.7656,23.8906 L81.7656,24.9844 C81.7656,26.6875 83.0625,27.7813 85.1094,27.7813 C85.875,27.7813 86.5625,27.6563 86.9844,27.3906 C87.1719,27.2969 87.1719,27.2969 87.625,26.8125 C87.8125,26.625 88.0156,26.5469 88.2344,26.5469 C88.7031,26.5469 89.0938,26.9375 89.0938,27.3906 C89.0938,27.7813 88.7656,28.2344 88.1875,28.6406 C87.4375,29.1875 86.2813,29.4844 85.0625,29.4844 C82.1719,29.4844 80.0625,27.5938 80.0625,25.0156 L80.0625,23.8906 C80.0625,21.1719 82.0625,19.0938 84.6875,19.0938 C85.5625,19.0938 86.1563,19.2344 87.0938,19.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="105.25" y="28.1543">Observable</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="10" x2="238" y1="40" y2="40"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="10" x2="238" y1="48" y2="48"/><ellipse cx="20" cy="59.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="190" x="29" y="62.2104">addObserver(Observer observer)</text><ellipse cx="20" cy="72.707" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="204" x="29" y="75.0151">deleteObserver(Observer observer)</text><ellipse cx="20" cy="85.5117" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="92" x="29" y="87.8198">notifyObserver()</text><ellipse cx="20" cy="98.3164" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="29" y="100.6245">setChanged()</text><!--class ConcreteSubject--><rect fill="#FEFECE" filter="url(#f1p72u34qysgli)" height="48" id="ConcreteSubject" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="127" y="190.5"/><ellipse cx="142" cy="206.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M144.3438,202.1719 L144.5156,202.25 C144.7344,201.9375 144.9375,201.8438 145.2344,201.8438 C145.5313,201.8438 145.8125,201.9844 145.9688,202.25 C146.0625,202.4063 146.0781,202.5313 146.0781,202.9688 L146.0781,204.3906 C146.0781,204.8125 146.0469,205 145.9375,205.1563 C145.7656,205.375 145.5,205.5156 145.2344,205.5156 C145.0156,205.5156 144.7813,205.4063 144.6406,205.2656 C144.5,205.1406 144.4688,205.0156 144.4063,204.6094 C144.3125,204.2031 144.1406,203.9844 143.6563,203.7031 C143.1875,203.4531 142.5781,203.2969 142,203.2969 C140.2656,203.2969 139.0156,204.6094 139.0156,206.3906 L139.0156,207.4844 C139.0156,209.1875 140.3125,210.2813 142.3594,210.2813 C143.125,210.2813 143.8125,210.1563 144.2344,209.8906 C144.4219,209.7969 144.4219,209.7969 144.875,209.3125 C145.0625,209.125 145.2656,209.0469 145.4844,209.0469 C145.9531,209.0469 146.3438,209.4375 146.3438,209.8906 C146.3438,210.2813 146.0156,210.7344 145.4375,211.1406 C144.6875,211.6875 143.5313,211.9844 142.3125,211.9844 C139.4219,211.9844 137.3125,210.0938 137.3125,207.5156 L137.3125,206.3906 C137.3125,203.6719 139.3125,201.5938 141.9375,201.5938 C142.8125,201.5938 143.4063,201.7344 144.3438,202.1719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="104" x="156" y="210.6543">ConcreteSubject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="128" x2="262" y1="222.5" y2="222.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="128" x2="262" y1="230.5" y2="230.5"/><!--class ConcreteObserver--><rect fill="#FEFECE" filter="url(#f1p72u34qysgli)" height="60.8047" id="ConcreteObserver" style="stroke: #A80036; stroke-width: 1.5;" width="145" x="60.5" y="322"/><ellipse cx="75.5" cy="338" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M77.8438,333.6719 L78.0156,333.75 C78.2344,333.4375 78.4375,333.3438 78.7344,333.3438 C79.0313,333.3438 79.3125,333.4844 79.4688,333.75 C79.5625,333.9063 79.5781,334.0313 79.5781,334.4688 L79.5781,335.8906 C79.5781,336.3125 79.5469,336.5 79.4375,336.6563 C79.2656,336.875 79,337.0156 78.7344,337.0156 C78.5156,337.0156 78.2813,336.9063 78.1406,336.7656 C78,336.6406 77.9688,336.5156 77.9063,336.1094 C77.8125,335.7031 77.6406,335.4844 77.1563,335.2031 C76.6875,334.9531 76.0781,334.7969 75.5,334.7969 C73.7656,334.7969 72.5156,336.1094 72.5156,337.8906 L72.5156,338.9844 C72.5156,340.6875 73.8125,341.7813 75.8594,341.7813 C76.625,341.7813 77.3125,341.6563 77.7344,341.3906 C77.9219,341.2969 77.9219,341.2969 78.375,340.8125 C78.5625,340.625 78.7656,340.5469 78.9844,340.5469 C79.4531,340.5469 79.8438,340.9375 79.8438,341.3906 C79.8438,341.7813 79.5156,342.2344 78.9375,342.6406 C78.1875,343.1875 77.0313,343.4844 75.8125,343.4844 C72.9219,343.4844 70.8125,341.5938 70.8125,339.0156 L70.8125,337.8906 C70.8125,335.1719 72.8125,333.0938 75.4375,333.0938 C76.3125,333.0938 76.9063,333.2344 77.8438,333.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="113" x="89.5" y="342.1543">ConcreteObserver</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="61.5" x2="204.5" y1="354" y2="354"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="61.5" x2="204.5" y1="362" y2="362"/><ellipse cx="71.5" cy="373.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="80.5" y="376.2104">update()</text><!--link Observer to ConcreteObserver--><path d="M77.7964,262.123 C89.955,281.808 103.7569,304.1541 114.519,321.578 " fill="none" id="Observer-ConcreteObserver" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="71.7811,265.704,67.2267,245.01,83.6922,258.347,71.7811,265.704" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ConcreteSubject to ConcreteObserver--><path d="M182.333,243.286 C171.939,266.084 157.255,298.2953 146.612,321.6411 " fill="none" id="ConcreteSubject-ConcreteObserver" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="184.483,238.571,177.11,245.1009,182.4089,243.1205,184.3893,248.4194,184.483,238.571" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="168" y="288.0669">subject</text><!--link Observable to Observer--><path d="M76.7874,107.215 C69.8457,116.521 63.5221,126.618 59,137 C53.3809,149.901 50.6895,165.096 49.4693,178.53 " fill="none" id="Observable-Observer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="49.0578,183.778,53.7501,175.1188,49.4492,178.7933,45.7746,174.4925,49.0578,183.778" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="60" y="150.0669">many Observer</text><!--link Observable to ConcreteSubject--><path d="M161.514,125.413 C163.426,129.305 165.269,133.186 167,137 C174.948,154.515 182.354,175.011 187.55,190.377 " fill="none" id="Observable-ConcreteSubject" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="155.14,128.324,152.22,107.336,167.59,121.923,155.14,128.324" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
interface Observer {
+update()
}
class Observable {
+addObserver(Observer observer)
+deleteObserver(Observer observer)
+notifyObserver()
+setChanged()
}
class ConcreteSubject {
}
class ConcreteObserver {
+update()
}
Observer <|.. ConcreteObserver 
ConcreteSubject <- - ConcreteObserver: subject
Observable - -> Observer : many Observer
Observable <|.. ConcreteSubject
@enduml
--></g></svg>
* 其中setChanged()方法标记改变状态。
## 观察者模式运行过程
1. 创建一个主题。
2. 将需要注册为订阅者的对象通过主题进行注册
3. 主题内容改变，将变化一一发送给订阅者
4. 删除订阅
例如：
通过主题的registerObserver()方法将需要订阅对象加入，订阅名单中。
主题内容改变时，触发notifyObserver()方法将变化后的值，一一推送给订阅者
通过主题的removeObserver()方法取消订阅
