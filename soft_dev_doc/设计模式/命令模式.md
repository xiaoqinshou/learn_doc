# 命令模式
* 将需要做的事情封装成一个命令，不关心如何实现，只关心调用哪个方法使用，可以根据不同的命令块，去执行不同的命令
[toc]

## 何为命令模式
* 命令模式将“请求”封装成对象，以便使用不同的请求、队列或者日志来参数化其他对象。命令模式也支持可撤销的操作。

## 命令模式的定义
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="239px" preserveAspectRatio="none" style="width:571px;height:239px;" version="1.1" viewBox="0 0 571 239" width="571px" zoomAndPan="magnify"><defs><filter height="300%" id="f15f09znwkbcak" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class Client--><rect fill="#FEFECE" filter="url(#f15f09znwkbcak)" height="73.6094" id="Client" style="stroke: #A80036; stroke-width: 1.5;" width="246" x="6" y="8"/><ellipse cx="107.25" cy="24" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M109.5938,19.6719 L109.7656,19.75 C109.9844,19.4375 110.1875,19.3438 110.4844,19.3438 C110.7813,19.3438 111.0625,19.4844 111.2188,19.75 C111.3125,19.9063 111.3281,20.0313 111.3281,20.4688 L111.3281,21.8906 C111.3281,22.3125 111.2969,22.5 111.1875,22.6563 C111.0156,22.875 110.75,23.0156 110.4844,23.0156 C110.2656,23.0156 110.0313,22.9063 109.8906,22.7656 C109.75,22.6406 109.7188,22.5156 109.6563,22.1094 C109.5625,21.7031 109.3906,21.4844 108.9063,21.2031 C108.4375,20.9531 107.8281,20.7969 107.25,20.7969 C105.5156,20.7969 104.2656,22.1094 104.2656,23.8906 L104.2656,24.9844 C104.2656,26.6875 105.5625,27.7813 107.6094,27.7813 C108.375,27.7813 109.0625,27.6563 109.4844,27.3906 C109.6719,27.2969 109.6719,27.2969 110.125,26.8125 C110.3125,26.625 110.5156,26.5469 110.7344,26.5469 C111.2031,26.5469 111.5938,26.9375 111.5938,27.3906 C111.5938,27.7813 111.2656,28.2344 110.6875,28.6406 C109.9375,29.1875 108.7813,29.4844 107.5625,29.4844 C104.6719,29.4844 102.5625,27.5938 102.5625,25.0156 L102.5625,23.8906 C102.5625,21.1719 104.5625,19.0938 107.1875,19.0938 C108.0625,19.0938 108.6563,19.2344 109.5938,19.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="127.75" y="28.1543">Client</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="251" y1="40" y2="40"/><ellipse cx="17" cy="51.9023" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="220" x="26" y="54.2104">ConcreteCommand concreteCommand</text><ellipse cx="17" cy="64.707" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="26" y="67.0151">Receiver receiver</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="251" y1="73.6094" y2="73.6094"/><!--class Receiver--><rect fill="#FEFECE" filter="url(#f15f09znwkbcak)" height="48" id="Receiver" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="86.5" y="161"/><ellipse cx="101.5" cy="177" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M103.8438,172.6719 L104.0156,172.75 C104.2344,172.4375 104.4375,172.3438 104.7344,172.3438 C105.0313,172.3438 105.3125,172.4844 105.4688,172.75 C105.5625,172.9063 105.5781,173.0313 105.5781,173.4688 L105.5781,174.8906 C105.5781,175.3125 105.5469,175.5 105.4375,175.6563 C105.2656,175.875 105,176.0156 104.7344,176.0156 C104.5156,176.0156 104.2813,175.9063 104.1406,175.7656 C104,175.6406 103.9688,175.5156 103.9063,175.1094 C103.8125,174.7031 103.6406,174.4844 103.1563,174.2031 C102.6875,173.9531 102.0781,173.7969 101.5,173.7969 C99.7656,173.7969 98.5156,175.1094 98.5156,176.8906 L98.5156,177.9844 C98.5156,179.6875 99.8125,180.7813 101.8594,180.7813 C102.625,180.7813 103.3125,180.6563 103.7344,180.3906 C103.9219,180.2969 103.9219,180.2969 104.375,179.8125 C104.5625,179.625 104.7656,179.5469 104.9844,179.5469 C105.4531,179.5469 105.8438,179.9375 105.8438,180.3906 C105.8438,180.7813 105.5156,181.2344 104.9375,181.6406 C104.1875,182.1875 103.0313,182.4844 101.8125,182.4844 C98.9219,182.4844 96.8125,180.5938 96.8125,178.0156 L96.8125,176.8906 C96.8125,174.1719 98.8125,172.0938 101.4375,172.0938 C102.3125,172.0938 102.9063,172.2344 103.8438,172.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="53" x="115.5" y="181.1543">Receiver</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="87.5" x2="170.5" y1="193" y2="193"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="87.5" x2="170.5" y1="201" y2="201"/><!--class ConcreteCommand--><rect fill="#FEFECE" filter="url(#f15f09znwkbcak)" height="86.4141" id="ConcreteCommand" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="207" y="142"/><ellipse cx="236.85" cy="158" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M239.1938,153.6719 L239.3656,153.75 C239.5844,153.4375 239.7875,153.3438 240.0844,153.3438 C240.3813,153.3438 240.6625,153.4844 240.8188,153.75 C240.9125,153.9063 240.9281,154.0313 240.9281,154.4688 L240.9281,155.8906 C240.9281,156.3125 240.8969,156.5 240.7875,156.6563 C240.6156,156.875 240.35,157.0156 240.0844,157.0156 C239.8656,157.0156 239.6313,156.9063 239.4906,156.7656 C239.35,156.6406 239.3188,156.5156 239.2563,156.1094 C239.1625,155.7031 238.9906,155.4844 238.5063,155.2031 C238.0375,154.9531 237.4281,154.7969 236.85,154.7969 C235.1156,154.7969 233.8656,156.1094 233.8656,157.8906 L233.8656,158.9844 C233.8656,160.6875 235.1625,161.7813 237.2094,161.7813 C237.975,161.7813 238.6625,161.6563 239.0844,161.3906 C239.2719,161.2969 239.2719,161.2969 239.725,160.8125 C239.9125,160.625 240.1156,160.5469 240.3344,160.5469 C240.8031,160.5469 241.1938,160.9375 241.1938,161.3906 C241.1938,161.7813 240.8656,162.2344 240.2875,162.6406 C239.5375,163.1875 238.3813,163.4844 237.1625,163.4844 C234.2719,163.4844 232.1625,161.5938 232.1625,159.0156 L232.1625,157.8906 C232.1625,155.1719 234.1625,153.0938 236.7875,153.0938 C237.6625,153.0938 238.2563,153.2344 239.1938,153.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="254.15" y="162.1543">ConcreteCommand</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="208" x2="390" y1="174" y2="174"/><ellipse cx="218" cy="185.9023" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="227" y="188.2104">Receiver receiver</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="208" x2="390" y1="194.8047" y2="194.8047"/><ellipse cx="218" cy="206.707" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="227" y="209.0151">execute(){receiver.action()}</text><ellipse cx="218" cy="219.5117" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="227" y="221.8198">undo()</text><!--class Invoker--><rect fill="#FEFECE" filter="url(#f15f09znwkbcak)" height="73.6094" id="Invoker" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="287" y="8"/><ellipse cx="332.25" cy="24" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M334.5938,19.6719 L334.7656,19.75 C334.9844,19.4375 335.1875,19.3438 335.4844,19.3438 C335.7813,19.3438 336.0625,19.4844 336.2188,19.75 C336.3125,19.9063 336.3281,20.0313 336.3281,20.4688 L336.3281,21.8906 C336.3281,22.3125 336.2969,22.5 336.1875,22.6563 C336.0156,22.875 335.75,23.0156 335.4844,23.0156 C335.2656,23.0156 335.0313,22.9063 334.8906,22.7656 C334.75,22.6406 334.7188,22.5156 334.6563,22.1094 C334.5625,21.7031 334.3906,21.4844 333.9063,21.2031 C333.4375,20.9531 332.8281,20.7969 332.25,20.7969 C330.5156,20.7969 329.2656,22.1094 329.2656,23.8906 L329.2656,24.9844 C329.2656,26.6875 330.5625,27.7813 332.6094,27.7813 C333.375,27.7813 334.0625,27.6563 334.4844,27.3906 C334.6719,27.2969 334.6719,27.2969 335.125,26.8125 C335.3125,26.625 335.5156,26.5469 335.7344,26.5469 C336.2031,26.5469 336.5938,26.9375 336.5938,27.3906 C336.5938,27.7813 336.2656,28.2344 335.6875,28.6406 C334.9375,29.1875 333.7813,29.4844 332.5625,29.4844 C329.6719,29.4844 327.5625,27.5938 327.5625,25.0156 L327.5625,23.8906 C327.5625,21.1719 329.5625,19.0938 332.1875,19.0938 C333.0625,19.0938 333.6563,19.2344 334.5938,19.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="45" x="352.75" y="28.1543">Invoker</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="288" x2="430" y1="40" y2="40"/><ellipse cx="298" cy="51.9023" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="307" y="54.2104">Command command</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="288" x2="430" y1="60.8047" y2="60.8047"/><ellipse cx="298" cy="72.707" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="307" y="75.0151">setCommand()</text><!--class Command--><rect fill="#FEFECE" filter="url(#f15f09znwkbcak)" height="73.6094" id="Command" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="466" y="8"/><ellipse cx="481" cy="24" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M481.9531,20.7813 L481.9531,27.2969 L483.6719,27.2969 C484.125,27.2969 484.2656,27.3281 484.4375,27.4531 C484.6719,27.625 484.7813,27.875 484.7813,28.1563 C484.7813,28.7188 484.4219,29 483.6719,29 L478.5313,29 C478.125,29 477.9219,28.9531 477.7656,28.8281 C477.5469,28.6719 477.4063,28.4063 477.4063,28.1563 C477.4063,27.8594 477.5625,27.5781 477.8125,27.4219 C477.9688,27.3125 478.0938,27.2969 478.5313,27.2969 L480.25,27.2969 L480.25,20.7813 L478.5313,20.7813 C478.1094,20.7813 477.9219,20.75 477.7656,20.6406 C477.5469,20.4688 477.4063,20.2188 477.4063,19.9375 C477.4063,19.6563 477.5625,19.3594 477.8125,19.2031 C477.9688,19.1094 478.0938,19.0938 478.5313,19.0938 L483.6719,19.0938 C484.125,19.0938 484.2656,19.125 484.4375,19.2344 C484.6719,19.4063 484.7813,19.6719 484.7813,19.9375 C484.7813,20.2344 484.6406,20.5156 484.375,20.6719 C484.25,20.75 484.0625,20.7813 483.6719,20.7813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="495" y="28.1543">Command</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="467" x2="559" y1="40" y2="40"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="467" x2="559" y1="48" y2="48"/><ellipse cx="477" cy="59.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="486" y="62.2104">execute()</text><ellipse cx="477" cy="72.707" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="486" y="75.0151">undo()</text><!--link Command to ConcreteCommand--><path d="M448.922,87.321 C422.209,104.548 391.217,124.533 364.369,141.8463 " fill="none" id="Command-ConcreteCommand" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="445.17,81.412,465.772,76.456,452.757,93.177,445.17,81.412" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Invoker to Command--><path d="M431.188,45 C440.985,45 450.782,45 460.579,45 " fill="none" id="Invoker-Command" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="465.702,45,456.702,41,460.702,45,456.702,49,465.702,45" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Client to ConcreteCommand--><path d="M173.665,82.258 C194.961,99.545 220.655,120.402 243.22,138.7196 " fill="none" id="Client-ConcreteCommand" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="247.103,141.872,242.6367,133.0941,243.2211,138.7207,237.5945,139.3051,247.103,141.872" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Client to Receiver--><path d="M129,82.258 C129,105.227 129,134.4975 129,155.741 " fill="none" id="Client-Receiver" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="129,160.9602,133,151.9602,129,155.9602,125,151.9602,129,160.9602" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Receiver to ConcreteCommand--><path d="M176.994,185 C186.864,185 196.734,185 206.605,185 " fill="none" id="Receiver-ConcreteCommand" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="171.832,185,180.832,189,176.832,185,180.832,181,171.832,185" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
class Client{
+ConcreteCommand concreteCommand
+Receiver receiver
}
class Receiver{
}
class ConcreteCommand{
+Receiver receiver
+execute(){receiver.action()}
+undo()
}
class Invoker{
+Command command
+setCommand()
}
interface Command{
+execute()
+undo()
}
ConcreteCommand .up.|> Command
Invoker -right-> Command
Client- ->ConcreteCommand
Client- ->Receiver
ConcreteCommand-left->Receiver
@enduml
--></g></svg>
由一个连接器定义一个接收者，与一个实际命令，调用者在某一时刻使用这个连接器时，可以通过命令接口中的公共execute()方法执行命令。

## 常用用途
1. 队列请求
2. 日志请求

## 总结
* 命令模式实质性只是将一系列操作中，将命令视为变化的，调用命令的方式行为不变，从而进行封装，演变出来的设计模式。
* 命令一个接受命令，一个发起命令不变得一块，一个命令去对应的执行完毕就行，其中这个发起命令，接受命令，执行命令这个宏观过程是不会变化的，而例如谁是发起人，谁是接收者，命令是什么命令这是可变的。